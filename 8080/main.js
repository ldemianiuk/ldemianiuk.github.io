!function(t){var e={};function r(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(s,n,function(e){return t[e]}.bind(null,n));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t,e,r){t.exports=function(){"use strict";var t=/:([0-9A-Fa-f]{8,})([0-9A-Fa-f]{2})(?:\r\n|\r|\n|)/g;function e(t){return 255&-t.reduce((function(t,e){return t+e}),0)}function r(t){return t.toString(16).toUpperCase().padStart(2,"0")}Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};var s=function(t){if(this._blocks=new Map,t&&"function"==typeof t[Symbol.iterator])for(var e of t){if(!(e instanceof Array)||2!==e.length)throw new Error("First parameter to MemoryMap constructor must be an iterable of [addr, bytes] or undefined");this.set(e[0],e[1])}else if("object"==typeof t){var r=Object.keys(t);for(var s of r)this.set(parseInt(s),t[s])}else if(null!=t)throw new Error("First parameter to MemoryMap constructor must be an iterable of [addr, bytes] or undefined")},n={size:{configurable:!0}};return s.prototype.set=function(t,e){if(!Number.isInteger(t))throw new Error("Address passed to MemoryMap is not an integer");if(t<0)throw new Error("Address passed to MemoryMap is negative");if(!(e instanceof Uint8Array))throw new Error("Bytes passed to MemoryMap are not an Uint8Array");return this._blocks.set(t,e)},s.prototype.get=function(t){return this._blocks.get(t)},s.prototype.clear=function(){return this._blocks.clear()},s.prototype.delete=function(t){return this._blocks.delete(t)},s.prototype.entries=function(){return this._blocks.entries()},s.prototype.forEach=function(t,e){return this._blocks.forEach(t,e)},s.prototype.has=function(t){return this._blocks.has(t)},s.prototype.keys=function(){return this._blocks.keys()},s.prototype.values=function(){return this._blocks.values()},n.size.get=function(){return this._blocks.size},s.prototype[Symbol.iterator]=function(){return this._blocks[Symbol.iterator]()},s.fromHex=function(n,i){void 0===i&&(i=1/0);var o,a=new s,u=0,c=0,h=0;for(t.lastIndex=0;null!==(o=t.exec(n));){if(c++,u!==o.index)throw new Error("Malformed hex file: Could not parse between characters "+u+" and "+o.index+' ("'+n.substring(u,Math.min(o.index,u+16)).trim()+'")');u=t.lastIndex;var l=o[1],f=o[2],p=new Uint8Array(l.match(/[\da-f]{2}/gi).map((function(t){return parseInt(t,16)}))),A=p[0];if(A+4!==p.length)throw new Error("Mismatched record length at record "+c+" ("+o[0].trim()+"), expected "+A+" data bytes but actual length is "+(p.length-4));var g=e(p);if(parseInt(f,16)!==g)throw new Error("Checksum failed at record "+c+" ("+o[0].trim()+"), should be "+g.toString(16));var d=(p[1]<<8)+p[2],y=p[3],C=p.subarray(4);if(0===y){if(a.has(h+d))throw new Error("Duplicated data at record "+c+" ("+o[0].trim()+")");if(d+C.length>65536)throw new Error("Data at record "+c+" ("+o[0].trim()+") wraps over 0xFFFF. This would trigger ambiguous behaviour. Please restructure your data so that for every record the data offset plus the data length do not exceed 0xFFFF.");a.set(h+d,C)}else{if(0!==d)throw new Error("Record "+c+" ("+o[0].trim()+") must have 0000 as data offset.");switch(y){case 1:if(u!==n.length)throw new Error("There is data after an EOF record at record "+c);return a.join(i);case 2:h=(C[0]<<8)+C[1]<<4;break;case 3:break;case 4:h=(C[0]<<8)+C[1]<<16;break;case 5:break;default:throw new Error("Invalid record type 0x"+r(y)+" at record "+c+" (should be between 0x00 and 0x05)")}}}throw c?new Error("No EOF record at end of file"):new Error("Malformed .hex file, could not parse any registers")},s.prototype.join=function(t){void 0===t&&(t=1/0);for(var e=Array.from(this.keys()).sort((function(t,e){return t-e})),r=new Map,n=-1,i=-1,o=0,a=e.length;o<a;o++){var u=e[o],c=this.get(e[o]).length;if(i===u&&i-n<t)r.set(n,r.get(n)+c),i+=c;else{if(!(i<=u))throw new Error("Overlapping data around address 0x"+u.toString(16));r.set(u,c),n=u,i=u+c}}for(var h,l=new s,f=-1,p=0,A=e.length;p<A;p++){var g=e[p];r.has(g)&&(h=new Uint8Array(r.get(g)),l.set(g,h),f=g),h.set(this.get(g),g-f)}return l},s.overlapMemoryMaps=function(t){var e=new Set;for(var[,r]of t)for(var[s,n]of r)e.add(s),e.add(s+n.length);for(var i=Array.from(e.values()).sort((function(t,e){return t-e})),o=new Map,a=function(e,r){var s=i[e],n=i[e+1],a=[];for(var[u,c]of t){var h=Array.from(c.keys()).reduce((function(t,e){return e>s?t:Math.max(t,e)}),-1);if(-1!==h){var l=c.get(h),f=s-h,p=n-h;f<l.length&&a.push([u,l.subarray(f,p)])}}a.length&&o.set(s,a)},u=0,c=i.length-1;u<c;u++)a(u);return o},s.flattenOverlaps=function(t){return new s(Array.from(t.entries()).map((function(t){var e=t[0],r=t[1];return[e,r[r.length-1][1]]})))},s.prototype.paginate=function(t,e){if(void 0===t&&(t=1024),void 0===e&&(e=255),t<=0)throw new Error("Page size must be greater than zero");for(var r,n=new s,i=Array.from(this.keys()).sort((function(t,e){return t-e})),o=0,a=i.length;o<a;o++)for(var u=i[o],c=this.get(u),h=c.length,l=u+h,f=u-u%t;f<l;f+=t){(r=n.get(f))||((r=new Uint8Array(t)).fill(e),n.set(f,r));var p=f-u,A=void 0;p<=0?(A=c.subarray(0,Math.min(t+p,h)),r.set(A,-p)):(A=c.subarray(p,p+Math.min(t,h-p)),r.set(A,0))}return n},s.prototype.getUint32=function(t,e){for(var r=Array.from(this.keys()),s=0,n=r.length;s<n;s++){var i=r[s],o=this.get(i),a=o.length;if(i<=t&&t+4<=i+a)return new DataView(o.buffer,t-i,4).getUint32(0,e)}},s.prototype.asHexString=function(t){void 0===t&&(t=16);var s=0,n=-65536,i=[];if(t<=0)throw new Error("Size of record must be greater than zero");if(t>255)throw new Error("Size of record must be less than 256");for(var o,a,u,c=new Uint8Array(6),h=new Uint8Array(4),l=Array.from(this.keys()).sort((function(t,e){return t-e})),f=0,p=l.length;f<p;f++){var A=l[f],g=this.get(A);if(!(g instanceof Uint8Array))throw new Error("Block at offset "+A+" is not an Uint8Array");if(A<0)throw new Error("Block at offset "+A+" has a negative thus invalid address");var d=g.length;if(d){if(A>n+65535&&(n=A-A%65536,s=0,c[0]=2,c[1]=0,c[2]=0,c[3]=4,c[4]=n>>24,c[5]=n>>16,i.push(":"+Array.prototype.map.call(c,r).join("")+r(e(c)))),A<n+s)throw new Error("Block starting at 0x"+A.toString(16)+" overlaps with a previous block.");s=A%65536;var y=0,C=A+d;if(C>4294967295)throw new Error("Data cannot be over 0xFFFFFFFF");for(;n+s<C;){s>65535&&(n+=65536,s=0,c[0]=2,c[1]=0,c[2]=0,c[3]=4,c[4]=n>>24,c[5]=n>>16,i.push(":"+Array.prototype.map.call(c,r).join("")+r(e(c))));for(var b=-1;s<65536&&b;)if(b=Math.min(t,C-n-s,65536-s)){h[0]=b,h[1]=s>>8,h[2]=s,h[3]=0;var R=g.subarray(y,y+b);i.push(":"+Array.prototype.map.call(h,r).join("")+Array.prototype.map.call(R,r).join("")+r((o=R,a=void 0,u=void 0,a=h.reduce((function(t,e){return t+e}),0),u=o.reduce((function(t,e){return t+e}),0),255&-(a+u)))),y+=b,s+=b}}}}return i.push(":00000001FF"),i.join("\n")},s.prototype.clone=function(){var t=new s;for(var[e,r]of this)t.set(e,new Uint8Array(r));return t},s.fromPaddedUint8Array=function(t,e,r){if(void 0===e&&(e=255),void 0===r&&(r=64),!(t instanceof Uint8Array))throw new Error("Bytes passed to fromPaddedUint8Array are not an Uint8Array");for(var n=new s,i=0,o=-1,a=0,u=!1,c=t.length,h=0;h<c;h++)t[h]===e?++i>=r&&(-1!==o&&n.set(a,t.subarray(a,o+1)),u=!0):(u&&(u=!1,a=h),o=h,i=0);return u||-1===o||n.set(a,t.subarray(a,c)),n},s.prototype.slice=function(t,e){if(void 0===e&&(e=1/0),e<0)throw new Error("Length of the slice cannot be negative");var r=new s;for(var[n,i]of this){var o=i.length;if(n+o>=t&&n<t+e){var a=Math.max(t,n),u=Math.min(t+e,n+o)-a,c=a-n;u>0&&r.set(a,i.subarray(c,c+u))}}return r},s.prototype.slicePad=function(t,e,r){if(void 0===r&&(r=255),e<0)throw new Error("Length of the slice cannot be negative");var s=new Uint8Array(e).fill(r);for(var[n,i]of this){var o=i.length;if(n+o>=t&&n<t+e){var a=Math.max(t,n),u=Math.min(t+e,n+o)-a,c=a-n;u>0&&s.set(i.subarray(c,c+u),a-t)}}return s},s.prototype.contains=function(t){for(var[e,r]of t){var s=r.length,n=this.slice(e,s).join().get(e);if(!n||n.length!==s)return!1;for(var i in r)if(r[i]!==n[i])return!1}return!0},Object.defineProperties(s.prototype,n),s}()},function(t,e,r){},function(t,e,r){"use strict";r.r(e);var s=[121,254,9,202,22,236,254,2,202,18,236,118,123,211,1,201,26,254,"$".charCodeAt(0),200,211,1,19,195,22,236],n=[195,171,1,77,73,67,82,79,67,79,83,77,32,65,83,83,79,67,73,65,84,69,83,32,56,48,56,48,47,56,48,56,53,32,67,80,85,32,68,73,65,71,78,79,83,84,73,67,32,86,69,82,83,73,79,78,32,49,46,48,32,40,67,41,32,49,57,56,48,213,235,14,9,205,5,0,209,201,14,2,205,5,0,201,245,205,100,1,95,205,78,1,241,205,104,1,95,195,78,1,15,15,15,15,230,15,254,10,250,113,1,198,7,198,48,201,12,13,10,32,67,80,85,32,73,83,32,79,80,69,82,65,84,73,79,78,65,76,36,12,13,10,32,67,80,85,32,72,65,83,32,70,65,73,76,69,68,33,32,69,82,82,79,82,32,69,88,73,84,61,36,49,173,7,230,0,202,182,1,205,137,6,210,188,1,205,137,6,234,194,1,205,137,6,242,200,1,205,137,6,194,215,1,218,215,1,226,215,1,250,215,1,195,218,1,205,137,6,198,6,194,226,1,205,137,6,218,235,1,226,235,1,242,238,1,205,137,6,198,112,226,246,1,205,137,6,250,255,1,202,255,1,210,2,2,205,137,6,198,129,250,10,2,205,137,6,202,19,2,218,19,2,226,22,2,205,137,6,198,254,218,30,2,205,137,6,202,39,2,226,39,2,250,42,2,205,137,6,254,0,218,66,2,202,66,2,254,245,218,66,2,194,66,2,254,255,202,66,2,218,69,2,205,137,6,206,10,206,10,254,11,202,81,2,205,137,6,214,12,214,15,254,240,202,93,2,205,137,6,222,241,222,14,254,240,202,105,2,205,137,6,230,85,254,80,202,115,2,205,137,6,246,58,254,122,202,125,2,205,137,6,238,15,254,117,202,135,2,205,137,6,230,0,220,137,6,228,137,6,252,137,6,196,137,6,254,0,202,157,2,205,137,6,214,119,212,137,6,236,137,6,244,137,6,204,137,6,254,137,202,179,2,205,137,6,230,255,228,192,2,254,217,202,29,3,205,137,6,232,198,16,236,204,2,198,2,224,205,137,6,224,198,32,252,216,2,198,4,232,205,137,6,240,198,128,244,228,2,198,128,248,205,137,6,248,198,64,212,240,2,198,64,240,205,137,6,216,198,143,220,252,2,214,2,208,205,137,6,208,198,247,196,8,3,198,254,216,205,137,6,200,198,1,204,20,3,198,208,192,205,137,6,192,198,71,254,71,200,205,137,6,62,119,60,71,4,72,13,81,90,99,108,125,61,79,89,107,69,80,98,124,87,20,106,77,12,97,68,5,88,123,95,28,67,96,36,76,105,85,21,122,103,37,84,66,104,44,93,29,75,121,111,45,101,92,83,74,65,120,254,119,196,137,6,175,6,1,14,3,22,7,30,15,38,31,46,63,128,129,130,131,132,133,135,254,240,196,137,6,144,145,146,147,148,149,254,120,196,137,6,151,196,137,6,62,128,135,6,1,14,2,22,3,30,4,38,5,46,6,136,6,128,128,128,137,128,128,138,128,128,139,128,128,140,128,128,141,128,128,143,254,55,196,137,6,62,128,135,6,1,152,6,255,128,153,128,154,128,155,128,156,128,157,254,224,196,137,6,62,128,135,159,254,255,196,137,6,62,255,6,254,14,252,22,239,30,127,38,244,46,191,167,161,162,163,164,165,167,254,36,196,137,6,175,6,1,14,2,22,4,30,8,38,16,46,32,176,177,178,179,180,181,183,254,63,196,137,6,62,0,38,143,46,79,168,169,170,171,172,173,254,207,196,137,6,175,196,137,6,6,68,14,69,22,70,30,71,38,6,46,166,112,6,0,70,62,68,184,196,137,6,114,22,0,86,62,70,186,196,137,6,115,30,0,94,62,71,187,196,137,6,116,38,6,46,166,102,62,6,188,196,137,6,117,38,6,46,166,110,62,166,189,196,137,6,38,6,46,166,62,50,119,190,196,137,6,134,254,100,196,137,6,175,126,254,50,196,137,6,38,6,46,166,126,150,196,137,6,62,128,135,142,254,51,196,137,6,62,128,135,158,254,205,196,137,6,166,196,137,6,62,37,182,254,55,196,137,6,174,254,5,196,137,6,54,85,52,53,134,254,90,196,137,6,1,255,18,17,255,18,33,255,18,3,19,35,62,19,184,196,137,6,186,196,137,6,188,196,137,6,62,0,185,196,137,6,187,196,137,6,189,196,137,6,11,27,43,62,18,184,196,137,6,186,196,137,6,188,196,137,6,62,255,185,196,137,6,187,196,137,6,189,196,137,6,50,166,6,175,58,166,6,254,255,196,137,6,42,164,6,34,166,6,58,164,6,71,58,166,6,184,196,137,6,58,165,6,71,58,167,6,184,196,137,6,62,170,50,166,6,68,77,175,10,254,170,196,137,6,60,2,58,166,6,254,171,196,137,6,62,119,50,166,6,42,164,6,17,0,0,235,175,26,254,119,196,137,6,175,132,133,196,137,6,62,204,18,58,166,6,254,204,18,58,166,6,254,204,196,137,6,33,119,119,41,62,238,188,196,137,6,189,196,137,6,33,85,85,1,255,255,9,62,85,212,137,6,188,196,137,6,62,84,189,196,137,6,33,170,170,17,51,51,25,62,221,188,196,137,6,189,196,137,6,55,212,137,6,63,220,137,6,62,170,47,254,85,196,137,6,183,39,254,85,196,137,6,62,136,135,39,254,118,196,137,6,175,62,170,39,212,137,6,254,16,196,137,6,175,62,154,39,212,137,6,196,137,6,55,62,66,7,220,137,6,7,212,137,6,254,9,196,137,6,15,212,137,6,15,254,66,196,137,6,23,23,212,137,6,254,8,196,137,6,31,31,220,137,6,254,2,196,137,6,1,52,18,17,170,170,33,85,85,175,197,213,229,245,1,0,0,17,0,0,33,0,0,62,192,198,240,241,225,209,193,220,137,6,196,137,6,228,137,6,252,137,6,62,18,184,196,137,6,62,52,185,196,137,6,62,170,186,196,137,6,187,196,137,6,62,85,188,196,137,6,189,196,137,6,33,0,0,57,34,171,6,49,170,6,59,59,51,59,62,85,50,168,6,47,50,169,6,193,184,196,137,6,47,185,196,137,6,33,170,6,249,33,51,119,59,59,227,58,169,6,254,119,196,137,6,58,168,6,254,51,196,137,6,62,85,189,196,137,6,47,188,196,137,6,42,171,6,249,33,155,6,233,33,139,1,205,69,1,227,124,205,84,1,125,205,84,1,195,0,0,33,116,1,205,69,1,195,0,0,166,6,0,0,0,0,0,0,0],i=r(0),o=["NOP","LXI","STAX","INX","INR","DCR","MVI","RLC","NOP","DAD","LDAX","DCX","INR","DCR","MVI","RRC","NOP","LXI","STAX","INX","INR","DCR","MVI","RAL","NOP","DAD","LDAX","DCX","INR","DCR","MVI","RAR","NOP","LXI","SHLD","INX","INR","DCR","MVI","DAA","NOP","DAD","LHLD","DCX","INR","DCR","MVI","CMA","NOP","LXI","STA","INX","INR","DCR","MVI","STC","NOP","DAD","LDA","DCX","INR","DCR","MVI","CMC","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","HLT","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","MOV","ADD","ADD","ADD","ADD","ADD","ADD","ADD","ADD","ADC","ADC","ADC","ADC","ADC","ADC","ADC","ADC","SUB","SUB","SUB","SUB","SUB","SUB","SUB","SUB","SBB","SBB","SBB","SBB","SBB","SBB","SBB","SBB","ANA","ANA","ANA","ANA","ANA","ANA","ANA","ANA","XRA","XRA","XRA","XRA","XRA","XRA","XRA","XRA","ORA","ORA","ORA","ORA","ORA","ORA","ORA","ORA","CMP","CMP","CMP","CMP","CMP","CMP","CMP","CMP","RNZ","POP","JNZ","JMP","CNZ","PUSH","ADI","RST","RZ","RET","JZ","JMP","CZ","CALL","ACI","RST","RNC","POP","JNC","OUT","CNC","PUSH","SUI","RST","RC","RET","JC","IN","CC","CALL","SBI","RST","RPO","POP","JPO","XTHL","CPO","PUSH","ANI","RST","RPE","PCHL","JPE","XCHG","CPE","CALL","XRI","RST","RP","POP","JP","DI","CP","PUSH","ORI","RST","RM","SPHL","JM","EI","CM","CALL","CPI","RST"],a=[1,3,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,3,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,3,3,1,1,1,2,1,1,1,3,1,1,1,2,1,1,3,3,1,1,1,2,1,1,1,3,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,1,2,1,1,1,3,3,3,3,2,1,1,1,3,2,3,1,2,1,1,1,3,2,3,3,2,1,1,1,3,1,3,1,2,1,1,1,3,1,3,3,2,1,1,1,3,1,3,1,2,1,1,1,3,1,3,3,2,1],u=["NOP","LXI B","STAX B","INX B","INR B","DCR B","MVI B","RLC","NOP","DAD B","LDAX B","DCX B","INR C","DCR C","MVI C","RRC","NOP","LXI D","STAX D","INX D","INR D","DCR D","MVI D","RAL","NOP","DAD D","LDAX D","DCX D","INR E","DCR E","MVI E","RAR","NOP","LXI H","SHLD","INX H","INR H","DCR H","MVI H","DAA","NOP","DAD H","LHLD","DCX H","INR L","DCR L","MVI L","CMA","NOP","LXI SP","STA","INX SP","INR M","DCR M","MVI M","STC","NOP","DAD SP","LDA","DCX SP","INR A","DCR A","MVI A","CMC","MOV B, B","MOV B, C","MOV B, D","MOV B, E","MOV B, H","MOV B, L","MOV B, M","MOV B, A","MOV C, B","MOV C, C","MOV C, D","MOV C, E","MOV C, H","MOV C, L","MOV C, M","MOV C, A","MOV D, B","MOV D, C","MOV D, D","MOV D, E","MOV D, H","MOV D, L","MOV D, M","MOV D, A","MOV E, B","MOV E, C","MOV E, D","MOV E, E","MOV E, H","MOV E, L","MOV E, M","MOV E, A","MOV H, B","MOV H, C","MOV H, D","MOV H, E","MOV H, H","MOV H, L","MOV H, M","MOV H, A","MOV L, B","MOV L, C","MOV L, D","MOV L, E","MOV L, H","MOV L, L","MOV L, M","MOV L, A","MOV M, B","MOV M, C","MOV M, D","MOV M, E","MOV M, H","MOV M, L","HLT","MOV M, A","MOV A, B","MOV A, C","MOV A, D","MOV A, E","MOV A, H","MOV A, L","MOV A, M","MOV A, A","ADD B","ADD C","ADD D","ADD E","ADD H","ADD L","ADD M","ADD A","ADC B","ADC C","ADC D","ADC E","ADC H","ADC L","ADC M","ADC A","SUB B","SUB C","SUB D","SUB E","SUB H","SUB L","SUB M","SUB A","SBB B","SBB C","SBB D","SBB E","SBB H","SBB L","SBB M","SBB A","ANA B","ANA C","ANA D","ANA E","ANA H","ANA L","ANA M","ANA A","XRA B","XRA C","XRA D","XRA E","XRA H","XRA L","XRA M","XRA A","ORA B","ORA C","ORA D","ORA E","ORA H","ORA L","ORA M","ORA A","CMP B","CMP C","CMP D","CMP E","CMP H","CMP L","CMP M","CMP A","RNZ","POP B","JNZ","JMP","CNZ","PUSH B","ADI","RST 0","RZ","RET","JZ","JMP","CZ","CALL","ACI","RST 1","RNC","POP D","JNC","OUT","CNC","PUSH D","SUI","RST 2","RC","RET","JC","IN","CC","CALL","SBI","RST 3","RPO","POP H","JPO","XTHL","CPO","PUSH H","ANI","RST 4","RPE","PCHL","JPE","XCHG","CPE","CALL","XRI","RST 5","RP","POP PSW","JP","DI","CP","PUSH PSW","ORI","RST 6","RM","SPHL","JM","EI","CM","CALL","CPI","RST 7"],c=[4,10,7,5,5,5,7,4,4,10,7,5,5,5,7,4,4,10,7,5,5,5,7,4,4,10,7,5,5,5,7,4,4,10,16,5,5,5,7,4,4,10,16,5,5,5,7,4,4,10,13,5,10,10,10,4,4,10,13,5,5,5,7,4,5,5,5,5,5,5,7,5,5,5,5,5,5,5,7,5,5,5,5,5,5,5,7,5,5,5,5,5,5,5,7,5,5,5,5,5,5,5,7,5,5,5,5,5,5,5,7,5,7,7,7,7,7,7,7,7,5,5,5,5,5,5,7,5,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,5,10,10,10,11,11,7,11,5,10,10,10,11,17,7,11,5,10,10,10,11,11,7,11,5,10,10,10,11,17,7,11,5,10,10,18,11,11,7,11,5,5,10,5,11,17,7,11,5,10,10,4,11,11,7,11,5,5,10,4,11,17,7,11],h=[!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!1,!0,!1,!1,!0,!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!1,!0,!1,!0,!0,!1,!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!1,!0,!1,!1,!0,!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!1,!0,!1,!0,!0,!1,!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!1,!0,!1,!1,!0,!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!1,!0,!1,!0,!0,!1,!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!1,!0,!1,!1,!0,!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!1,!0,!1,!0,!0,!1,!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!1,!0,!1,!1,!0,!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!1,!0,!1,!1,!0,!0,!1,!1,!0,!1,!0,!0,!1,!0,!1,!1,!0,!1,!0,!0,!1,!1,!0,!0,!1,!0,!1,!1,!0],l=["No operation","B <- byte 3, C <- byte 2","(BC) <- A","BC <- BC+1","B <- B+1","B <- B-1","B <- byte 2","A = A << 1; bit 0 = prev bit 7; CY = prev bit 7","INVALID No operation","HL = HL + BC","A <- (BC)","BC = BC-1","C <- C+1","C <-C-1","C <- byte 2","A = A >> 1; bit 7 = prev bit 0; CY = prev bit 0","INVALID No operation","D <- byte 3, E <- byte 2","(DE) <- A","DE <- DE + 1","D <- D+1","D <- D-1","D <- byte 2","A = A << 1; bit 0 = prev CY; CY = prev bit 7","INVALID No operation","HL = HL + DE","A <- (DE)","DE = DE-1","E <-E+1","E <- E-1","E <- byte 2","A = A >> 1; bit 7 = prev bit 7; CY = prev bit 0","INVALID No operation","H <- byte 3, L <- byte 2","(adr) <-L; (adr+1)<-H","HL <- HL + 1","H <- H+1","H <- H-1","H <- byte 2","Decimal adjust after addition","INVALID No operation","HL = HL + HI","L <- (adr); H<-(adr+1)","HL = HL-1","L <- L+1","L <- L-1","L <- byte 2","A <- !A","INVALID No operation","SP.hi <- byte 3, SP.lo <- byte 2","(adr) <- A","SP = SP + 1","(HL) <- (HL)+1","(HL) <- (HL)-1","(HL) <- byte 2","CY = 1","INVALID No operation","HL = HL + SP","A <- (adr)","SP = SP-1","A <- A+1","A <- A-1","A <- byte 2","CY=!CY","B <- B","B <- C","B <- D","B <- E","B <- H","B <- L","B <- (HL)","B <- A","C <- B","C <- C","C <- D","C <- E","C <- H","C <- L","C <- (HL)","C <- A","D <- B","D <- C","D <- D","D <- E","D <- H","D <- L","D <- (HL)","D <- A","E <- B","E <- C","E <- D","E <- E","E <- H","E <- L","E <- (HL)","E <- A","H <- B","H <- C","H <- D","H <- E","H <- H","H <- L","H <- (HL)","H <- A","L <- B","L <- C","L <- D","L <- E","L <- H","L <- L","L <- (HL)","L <- A","(HL) <- B","(HL) <- C","(HL) <- D","(HL) <- E","(HL) <- H","(HL) <- L","Halt","(HL) <- A","A <- B","A <- C","A <- D","A <- E","A <- H","A <- L","A <- (HL)","A <- A","A <- A + B","A <- A + C","A <- A + D","A <- A + E","A <- A + H","A <- A + L","A <- A + (HL)","A <- A + A","A <- A + B + CY","A <- A + C + CY","A <- A + D + CY","A <- A + E + CY","A <- A + H + CY","A <- A + L + CY","A <- A + (HL) + CY","A <- A + A + CY","A <- A - B","A <- A - C","A <- A + D","A <- A - E","A <- A + H","A <- A - L","A <- A + (HL)","A <- A - A","A <- A - B - CY","A <- A - C - CY","A <- A - D - CY","A <- A - E - CY","A <- A - H - CY","A <- A - L - CY","A <- A - (HL) - CY","A <- A - A - CY","A <- A & B","A <- A & C","A <- A & D","A <- A & E","A <- A & H","A <- A & L","A <- A & (HL)","A <- A & A","A <- A ^ B","A <- A ^ C","A <- A ^ D","A <- A ^ E","A <- A ^ H","A <- A ^ L","A <- A ^ (HL)","A <- A ^ A","A <- A | B","A <- A | C","A <- A | D","A <- A | E","A <- A | H","A <- A | L","A <- A | (HL)","A <- A | A","A - B","A - C","A - D","A - E","A - H","A - L","A - (HL)","A - A","if NZ, RET","C <- (sp); B <- (sp+1); sp <- sp+2","if NZ, PC <- adr","PC <= adr","if NZ, CALL adr","(sp-2)<-C; (sp-1)<-B; sp <- sp - 2","A <- A + byte","CALL $0","if Z, RET","PC.lo <- (sp); PC.hi<-(sp+1); SP <- SP+2","if Z, PC <- adr","INVALID PC <= adr","if Z, CALL adr","(SP-1)<-PC.hi;(SP-2)<-PC.lo;SP<-SP-2;PC=adr","A <- A + data + CY","CALL $8","if NCY, RET","E <- (sp); D <- (sp+1); sp <- sp+2","if NCY, PC<-adr","Output AL to port D8","if NCY, CALL adr","(sp-2)<-E; (sp-1)<-D; sp <- sp - 2","A <- A - data","CALL $10","if CY, RET","INVALID RET","if CY, PC<-adr","Input from port D8 to AL","if CY, CALL adr","INVALID CALL","A <- A - data - CY","CALL $18","if PO, RET","L <- (sp); H <- (sp+1); sp <- sp+2","if PO, PC <- adr","L <-> (SP); H <-> (SP+1)","if PO, CALL adr","(sp-2)<-L; (sp-1)<-H; sp <- sp - 2","A <- A & data","CALL $20","if PE, RET","PC.hi <- H; PC.lo <- L","if PE, PC <- adr","H <-> D; L <-> E","if PE, CALL adr","INVALID CALL","A <- A ^ data","CALL $28","if P, RET","flags <- (sp); A <- (sp+1); sp <- sp+2","if P=1 PC <- adr","Disable interrputs","if P, PC <- adr","(sp-2)<-flags; (sp-1)<-A; sp <- sp - 2","A <- A | data","CALL $30","if M, RET","SP=HL","if M, PC <- adr","Enable interrputs","if M, CALL adr","INVALID CALL","A - data","CALL $38"],f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function p(t,e){function r(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function A(t){return"function"==typeof t}var g=!1,d={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;g=t},get useDeprecatedSynchronousErrorHandling(){return g}};function y(t){setTimeout((function(){throw t}),0)}var C={closed:!0,next:function(t){},error:function(t){if(d.useDeprecatedSynchronousErrorHandling)throw t;y(t)},complete:function(){}},b=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();var R=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),m=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var r,s=this._parentOrParents,n=this._ctorUnsubscribe,i=this._unsubscribe,o=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,s instanceof t)s.remove(this);else if(null!==s)for(var a=0;a<s.length;++a){s[a].remove(this)}if(A(i)){n&&(this._unsubscribe=void 0);try{i.call(this)}catch(t){e=t instanceof R?M(t.errors):[t]}}if(b(o)){a=-1;for(var u=o.length;++a<u;){var c=o[a];if(null!==(r=c)&&"object"==typeof r)try{c.unsubscribe()}catch(t){e=e||[],t instanceof R?e=e.concat(M(t.errors)):e.push(t)}}}if(e)throw new R(e)}},t.prototype.add=function(e){var r=e;if(!e)return t.EMPTY;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var s=r;(r=new t)._subscriptions=[s]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var n=r._parentOrParents;if(null===n)r._parentOrParents=this;else if(n instanceof t){if(n===this)return r;r._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return r;n.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function M(t){return t.reduce((function(t,e){return t.concat(e instanceof R?e.errors:e)}),[])}var H=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),v=function(t){function e(r,s,n){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=C;break;case 1:if(!r){i.destination=C;break}if("object"==typeof r){r instanceof e?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new O(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new O(i,r,s,n)}return i}return p(e,t),e.prototype[H]=function(){return this},e.create=function(t,r,s){var n=new e(t,r,s);return n.syncErrorThrowable=!1,n},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(m),O=function(t){function e(e,r,s,n){var i,o=t.call(this)||this;o._parentSubscriber=e;var a=o;return A(r)?i=r:r&&(i=r.next,s=r.error,n=r.complete,r!==C&&(A((a=Object.create(r)).unsubscribe)&&o.add(a.unsubscribe.bind(a)),a.unsubscribe=o.unsubscribe.bind(o))),o._context=a,o._next=i,o._error=s,o._complete=n,o}return p(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;d.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=d.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):y(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;y(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};d.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),d.useDeprecatedSynchronousErrorHandling)throw t;y(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!d.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return d.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(y(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(v);var D=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function L(t){return t}function E(t){return 0===t.length?L:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var S=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var s=this.operator,n=function(t,e,r){if(t){if(t instanceof v)return t;if(t[H])return t[H]()}return t||e||r?new v(t,e,r):new v(C)}(t,e,r);if(s?n.add(s.call(n,this.source)):n.add(this.source||d.useDeprecatedSynchronousErrorHandling&&!n.syncErrorThrowable?this._subscribe(n):this._trySubscribe(n)),d.useDeprecatedSynchronousErrorHandling&&n.syncErrorThrowable&&(n.syncErrorThrowable=!1,n.syncErrorThrown))throw n.syncErrorValue;return n},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){d.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,r=e.closed,s=e.destination,n=e.isStopped;if(r||n)return!1;t=s&&s instanceof v?s:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=P(e))((function(e,s){var n;n=r.subscribe((function(e){try{t(e)}catch(t){s(t),n&&n.unsubscribe()}}),s,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[D]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:E(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=P(t))((function(t,r){var s;e.subscribe((function(t){return s=t}),(function(t){return r(t)}),(function(){return t(s)}))}))},t.create=function(e){return new t(e)},t}();function P(t){if(t||(t=d.Promise||Promise),!t)throw new Error("no Promise impl found");return t}var w=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),V=function(t){function e(e,r){var s=t.call(this)||this;return s.subject=e,s.subscriber=r,s.closed=!1,s}return p(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var r=e.indexOf(this.subscriber);-1!==r&&e.splice(r,1)}}},e}(m),B=function(t){function e(e){var r=t.call(this,e)||this;return r.destination=e,r}return p(e,t),e}(v),I=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return p(e,t),e.prototype[H]=function(){return new B(this)},e.prototype.lift=function(t){var e=new N(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new w;if(!this.isStopped)for(var e=this.observers,r=e.length,s=e.slice(),n=0;n<r;n++)s[n].next(t)},e.prototype.error=function(t){if(this.closed)throw new w;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,r=e.length,s=e.slice(),n=0;n<r;n++)s[n].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new w;this.isStopped=!0;for(var t=this.observers,e=t.length,r=t.slice(),s=0;s<e;s++)r[s].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new w;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new w;return this.hasError?(t.error(this.thrownError),m.EMPTY):this.isStopped?(t.complete(),m.EMPTY):(this.observers.push(t),new V(this,t))},e.prototype.asObservable=function(){var t=new S;return t.source=this,t},e.create=function(t,e){return new N(t,e)},e}(S),N=function(t){function e(e,r){var s=t.call(this)||this;return s.destination=e,s.source=r,s}return p(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):m.EMPTY},e}(I);function _(t,e){return t<<8|e}function T(t){return 255&t}function U(t){return t>>8}function X(t){return 7&t}function x(t){return t>>3&7}var k=function(){};function F(t,e){return t<<8|e}var j=function(){function t(){this.status=new k,this.memory=new Uint8Array(65536),this.registers=new Uint8Array(8),this.sp=new Uint16Array(1),this.pc=new Uint16Array(1),this.output$=new Array(256);for(var t=0;t<256;t++)this.output$[t]=new I;this.reset()}return t.prototype.ret=function(t){void 0===t&&(t=6),this.pc[0]=F(this.memory[this.sp[0]+1],this.memory[this.sp[0]]),this.sp[0]+=2,this.cycles+=t},t.prototype.sub=function(t,e){var r=255^e,s=t+r+1;return this.setFlags(s),this.setCarry(s),this.status.C=!this.status.C,this.status.A=(15&t)+(15&r)+1>15,s},t.prototype.call=function(t,e,r){void 0===r&&(r=6);var s=F(t,e);this.sp[0]-=2,this.memory[this.sp[0]]=255&this.pc[0],this.memory[this.sp[0]+1]=function(t){return t>>8}(this.pc[0]),this.pc[0]=s,this.cycles+=r},t.prototype.setAC=function(t,e){this.status.A=(15&t)+(15&e)>15},t.prototype.setCarry=function(t){this.status.C=0!=(256&t)},t.prototype.setFlags=function(t){this.status.S=0!=(128&t),this.status.Z=0==(255&t),this.status.P=h[255&t]},t.prototype.parity=function(t){for(var e=1,r=0;r<8;r++)0!=(t&1<<r)&&e++;return 1==(1&e)},t.prototype.getReg=function(t){return 8===t?2|+this.status.C|+this.status.P<<2|0|+this.status.A<<4|0|+this.status.Z<<6|+this.status.S<<7:6===t?this.memory[F(this.registers[4],this.registers[5])]:this.registers[t]},t.prototype.setReg=function(t,e){8===t?(this.status.C=0!=(1&e),this.status.P=0!=(4&e),this.status.A=0!=(16&e),this.status.Z=0!=(64&e),this.status.S=0!=(128&e)):6===t?this.memory[F(this.registers[4],this.registers[5])]=e:this.registers[t]=e},t.prototype.reset=function(){this.registers.fill(0),this.memory.fill(0),this.sp[0]=61440,this.pc[0]=0,this.status.S=this.status.Z=this.status.A=this.status.P=this.status.C=!1,this.running=!0,this.cycles=0,this.instructions=0,this.input=[],this.trace=new Array(65536)},t.prototype.step=function(){if(this.running){var e=this.memory[this.pc[0]],r=o[e],s=a[e],n=this.memory[this.pc[0]+1&65535],i=this.memory[this.pc[0]+2&65535];this.trace[this.pc[0]]=("0000"+this.pc[0].toString(16)).slice(-4)+": "+this.disasm(this.pc[0]),this.pc[0]+=s,t.instructionHandlers[r].bind(this)?t.instructionHandlers[r].bind(this)(e,n,i):console.log("ERROR: "+r),this.cycles+=c[e],this.instructions++}},t.prototype.disasm=function(t,e){var r=this.memory[t],s=u[r],n=a[r];if(e>0){for(var i=[],o=t,c=0;c<e&&o<=65535;c++){var h=this.memory[o],f=a[h];i.push([o,this.disasm(o),l[h]]),o+=f}return i}return 0===e?[]:1===n?s:(s.includes(" ")&&(s+=","),2==n?s+" "+this.memory[t+1&65535].toString(16):s+" "+(this.memory[t+1&65535]+(this.memory[t+2&65535]<<8)).toString(16))},t.prototype.showFlags=function(){console.log("S:"+this.status.S+" Z:"+this.status.Z+" A:"+this.status.A+" P:"+this.status.P+" C:"+this.status.C)},t.registerHandler=function(e,r){t.instructionHandlers[e]=r},t.instructionHandlers={},t}();j.registerHandler("ACI",(function(t,e){var r=this.getReg(7),s=e,n=this.status.C?1:0,i=r+s+n;this.setReg(7,i),this.setFlags(i),this.setCarry(i),this.status.A=(15&r)+(15&s)+n>15})),j.registerHandler("ADC",(function(t){var e=this.getReg(7),r=this.getReg(X(t)),s=this.status.C?1:0,n=e+r+s;this.setReg(7,n),this.setFlags(n),this.setCarry(n),this.status.A=(15&e)+(15&r)+s>15})),j.registerHandler("ADD",(function(t){var e=this.getReg(7),r=this.getReg(X(t)),s=e+r;this.setReg(7,s),this.setFlags(s),this.setCarry(s),this.setAC(e,r)})),j.registerHandler("ADI",(function(t,e){var r=this.getReg(7),s=e,n=r+s;this.setReg(7,n),this.setFlags(n),this.setCarry(n),this.setAC(r,s)})),j.registerHandler("ANA",(function(t){var e=this.getReg(7)&this.getReg(X(t));this.setReg(7,e),this.setFlags(e),this.status.C=!1,this.status.A=!1})),j.registerHandler("ANI",(function(t,e){var r=this.getReg(7)&e;this.setReg(7,r),this.setFlags(r),this.status.C=!1,this.status.A=!1})),j.registerHandler("CALL",(function(t,e,r){this.call(r,e,0)})),j.registerHandler("CC",(function(t,e,r){this.status.C&&this.call(r,e)})),j.registerHandler("CM",(function(t,e,r){this.status.S&&this.call(r,e)})),j.registerHandler("CMA",(function(t){this.setReg(7,255^this.getReg(7))})),j.registerHandler("CMC",(function(t){this.status.C=!this.status.C})),j.registerHandler("CMP",(function(t){this.sub(this.getReg(7),this.getReg(X(t)))})),j.registerHandler("CNC",(function(t,e,r){this.status.C||this.call(r,e)})),j.registerHandler("CNZ",(function(t,e,r){this.status.Z||this.call(r,e)})),j.registerHandler("CP",(function(t,e,r){this.status.S||this.call(r,e)})),j.registerHandler("CPE",(function(t,e,r){this.status.P&&this.call(r,e)})),j.registerHandler("CPI",(function(t,e){this.sub(this.getReg(7),e)})),j.registerHandler("CPO",(function(t,e,r){this.status.P||this.call(r,e)})),j.registerHandler("CZ",(function(t,e,r){this.status.Z&&this.call(r,e)})),j.registerHandler("DAA",(function(t){var e=this.getReg(7);((15&e)>9||this.status.A)&&(e+=6,this.setReg(7,e),this.status.A=!0),(e>>4>9||this.status.C)&&(e+=96,this.setReg(7,e),this.status.C=!0)})),j.registerHandler("DAD",(function(t){var e;if(57===t)e=this.sp[0];else{var r=x(t),s=r-1;e=_(this.getReg(s),this.getReg(r))}var n=e+_(this.getReg(4),this.getReg(5));this.setReg(4,U(n)),this.setReg(5,T(n)),this.status.C=0!=(65536&n)})),j.registerHandler("DCR",(function(t){var e=this.getReg(x(t))-1;this.setReg(x(t),e),this.setFlags(e),this.setAC(this.getReg(x(t)),255)})),j.registerHandler("DCX",(function(t){if(59===t)this.sp[0]--;else{var e=x(t),r=e-1,s=_(this.getReg(r),this.getReg(e))-1;this.setReg(r,U(s)),this.setReg(e,T(s))}})),j.registerHandler("DI",(function(t){})),j.registerHandler("EI",(function(t){})),j.registerHandler("HLT",(function(t){this.running=!1,this.pc[0]--})),j.registerHandler("IN",(function(t,e){switch(e){case 0:this.input.length>0?this.setReg(7,255):this.setReg(7,0);break;case 1:this.setReg(7,this.input.shift());break;default:console.log("IN "+e)}})),j.registerHandler("INR",(function(t){var e=this.getReg(x(t))+1;this.setReg(x(t),e),this.setFlags(e),this.setAC(this.getReg(x(t)),1)})),j.registerHandler("INX",(function(t){if(51===t)this.sp[0]++;else{var e=x(t),r=e+1,s=_(this.getReg(e),this.getReg(r))+1;this.setReg(e,U(s)),this.setReg(r,T(s))}})),j.registerHandler("JC",(function(t,e,r){this.status.C&&(this.pc[0]=_(r,e))})),j.registerHandler("JM",(function(t,e,r){this.status.S&&(this.pc[0]=_(r,e))})),j.registerHandler("JMP",(function(t,e,r){this.pc[0]=_(r,e)})),j.registerHandler("JNC",(function(t,e,r){this.status.C||(this.pc[0]=_(r,e))})),j.registerHandler("JNZ",(function(t,e,r){this.status.Z||(this.pc[0]=_(r,e))})),j.registerHandler("JP",(function(t,e,r){this.status.S||(this.pc[0]=_(r,e))})),j.registerHandler("JPE",(function(t,e,r){this.status.P&&(this.pc[0]=_(r,e))})),j.registerHandler("JPO",(function(t,e,r){this.status.P||(this.pc[0]=_(r,e))})),j.registerHandler("JZ",(function(t,e,r){this.status.Z&&(this.pc[0]=_(r,e))})),j.registerHandler("LDA",(function(t,e,r){this.setReg(7,this.memory[_(r,e)])})),j.registerHandler("LDAX",(function(t){var e;e=10===t?_(this.registers[0],this.registers[1]):_(this.registers[2],this.registers[3]),this.setReg(7,this.memory[e])})),j.registerHandler("LHLD",(function(t,e,r){this.setReg(5,this.memory[_(r,e)]),this.setReg(4,this.memory[_(r,e)+1&65535])})),j.registerHandler("LXI",(function(t,e,r){if(49===t)this.sp[0]=_(r,e);else{var s=x(t),n=s+1;this.setReg(s,r),this.setReg(n,e)}})),j.registerHandler("MOV",(function(t){this.setReg(x(t),this.getReg(X(t)))})),j.registerHandler("MVI",(function(t,e){this.setReg(x(t),e)})),j.registerHandler("NOP",(function(t){})),j.registerHandler("ORA",(function(t){var e=this.getReg(7)|this.getReg(X(t));this.setReg(7,e),this.setFlags(e),this.status.C=!1,this.status.A=!1})),j.registerHandler("ORI",(function(t,e){var r=this.getReg(7)|e;this.setReg(7,r),this.setFlags(r),this.status.C=!1,this.status.A=!1})),j.registerHandler("OUT",(function(t,e){this.output$[e].observers.length>0?this.output$[e].next(this.getReg(7)):console.log("OUT "+e+", "+this.getReg(7))})),j.registerHandler("PCHL",(function(t){this.pc[0]=_(this.getReg(4),this.getReg(5))})),j.registerHandler("POP",(function(t){var e=_(this.memory[this.sp[0]+1],this.memory[this.sp[0]]);this.sp[0]+=2,241===t?(this.setReg(7,U(e)),this.setReg(8,T(e))):(this.setReg(x(t),U(e)),this.setReg(x(t)+1,T(e)))})),j.registerHandler("PUSH",(function(t){var e;e=245===t?_(this.getReg(7),this.getReg(8)):_(this.getReg(x(t)),this.getReg(x(t)+1)),this.sp[0]-=2,this.memory[this.sp[0]]=T(e),this.memory[this.sp[0]+1]=U(e)})),j.registerHandler("RAL",(function(t){var e=this.getReg(7),r=+this.status.C;this.status.C=0!=(128&e),this.setReg(7,e<<1|r)})),j.registerHandler("RAR",(function(t){var e=this.getReg(7),r=+this.status.C;this.status.C=0!=(1&e),this.setReg(7,e>>1|r<<7)})),j.registerHandler("RC",(function(t){this.status.C&&this.ret()})),j.registerHandler("RET",(function(t){this.ret(0)})),j.registerHandler("RLC",(function(t){var e=this.getReg(7);this.status.C=0!=(128&e),this.setReg(7,e<<1|+this.status.C)})),j.registerHandler("RM",(function(t){this.status.S&&this.ret()})),j.registerHandler("RNC",(function(t){this.status.C||this.ret()})),j.registerHandler("RNZ",(function(t){this.status.Z||this.ret()})),j.registerHandler("RP",(function(t){this.status.S||this.ret()})),j.registerHandler("RPE",(function(t){this.status.P&&this.ret()})),j.registerHandler("RPO",(function(t){this.status.P||this.ret()})),j.registerHandler("RRC",(function(t){var e=this.getReg(7);this.status.C=0!=(1&e),this.setReg(7,e>>1|+this.status.C<<7)})),j.registerHandler("RST",(function(t){var e=56&t;this.call(0,e,0)})),j.registerHandler("RZ",(function(t){this.status.Z&&this.ret()})),j.registerHandler("SBB",(function(t){this.setReg(7,this.sub(this.getReg(7),this.getReg(X(t))+ +this.status.C))})),j.registerHandler("SBI",(function(t,e){this.setReg(7,this.sub(this.getReg(7),e+ +this.status.C))})),j.registerHandler("SHLD",(function(t,e,r){this.memory[_(r,e)]=this.getReg(5),this.memory[_(r,e)+1&65535]=this.getReg(4)})),j.registerHandler("SPHL",(function(t){this.sp[0]=_(this.getReg(4),this.getReg(5))})),j.registerHandler("STA",(function(t,e,r){this.memory[_(r,e)]=this.getReg(7)})),j.registerHandler("STAX",(function(t){var e;e=2===t?_(this.registers[0],this.registers[1]):_(this.registers[2],this.registers[3]),this.memory[e]=this.getReg(7)})),j.registerHandler("STC",(function(t){this.status.C=!0})),j.registerHandler("SUB",(function(t){this.setReg(7,this.sub(this.getReg(7),this.getReg(X(t))))})),j.registerHandler("SUI",(function(t,e){this.setReg(7,this.sub(this.getReg(7),e))})),j.registerHandler("XCHG",(function(t){var e=this.getReg(2),r=this.getReg(3);this.setReg(2,this.getReg(4)),this.setReg(3,this.getReg(5)),this.setReg(4,e),this.setReg(5,r)})),j.registerHandler("XRA",(function(t){var e=this.getReg(7)^this.getReg(X(t));this.setReg(7,e),this.setFlags(e),this.status.C=!1,this.status.A=!1})),j.registerHandler("XRI",(function(t,e){var r=this.getReg(7)^e;this.setReg(7,r),this.setFlags(r),this.status.C=!1,this.status.A=!1})),j.registerHandler("XTHL",(function(t){var e=this.getReg(5),r=this.getReg(4);this.setReg(5,this.memory[this.sp[0]]),this.setReg(4,this.memory[this.sp[0]+1]),this.memory[this.sp[0]]=e,this.memory[this.sp[0]+1]=r}));r(1);var Z,Y=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],s=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},J=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var s,n,i=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(s=i.next()).done;)o.push(s.value)}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},$=new j,z="";$.output$[1].subscribe((function(t){if(13!==t){8===t?z=z.substr(0,z.length-1):z+=String.fromCharCode(t);var e=document.getElementById("output");e.innerHTML=z.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&quot;").replace(/'/g,"&#039;")+'<span class="blinking-cursor"> </span>',e.scrollTop=e.scrollHeight}}));var G=null,W=null;function q(){tt(),$.memory.set([118,0,0,0,0,195,6,236],0),$.memory.set(s,60422),$.memory.set(n,256),$.pc[0]=256,st()}function K(){clearTimeout(Z),Z=null,$.step(),st()}function Q(t){if(!Z){document.getElementById("output").focus();var e=(new Date).getTime();!function r(){for(var s=0;s<t;s++)if($.step(),$.pc[0]===G)return Z=null,void st();st(),$.running?Z=setTimeout(r,0):console.log("CPU halted. Ran "+$.cycles+" cycles in "+((new Date).getTime()-e)+" milliseconds.")}()}}function tt(){clearTimeout(Z),Z=null,$.reset(),z="",document.getElementById("output").innerHTML="",st()}function et(){return G=parseInt(document.getElementById("breakpoint").value,16),!1}function rt(){G=null}function st(){(null===W||$.pc[0]<W)&&(W=$.pc[0]);var t=$.disasm(W,20);$.pc[0]>t[15][0]&&(W=$.pc[0],t=$.disasm(W,20)),document.getElementById("code").innerHTML=t.map((function(t){return"<li "+(t[0]===$.pc[0]?'id="current"':"")+'><span class="tooltip"><span class="address">'+(("0000"+t[0].toString(16)).slice(-4)+"</span>: ")+t[1]+'<span class="tooltiptext">'+t[2]+"</span></span></li>"})).join(""),document.getElementById("register-values").innerHTML=[0,1,2,3,4,5,6,7].map((function(t){return"<td>"+("00"+$.getReg(t).toString(16)).slice(-2)+"</td>"})).join("");for(var e=Array.from($.memory.slice($.sp[0],Math.min($.sp[0]+40,65535))),r=[],s=$.sp[0];e.length>1;){var n=e.shift()+(e.shift()<<8);r.push("<li>"+("0000"+s.toString(16)).slice(-4)+": "+("0000"+n.toString(16)).slice(-4)+"</li>"),s+=2}document.getElementById("stack").innerHTML=r.join("");var i=Number(document.getElementById("page").value);document.getElementById("memory").innerHTML="<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;00&#8239;01&#8239;02&#8239;03&#8239;04&#8239;05&#8239;06&#8239;07&#8239;08&#8239;09&#8239;0A&#8239;0B&#8239;0C&#8239;0D&#8239;0E&#8239;0F</b><br>"+Array.from(Array(16).keys()).map((function(t){return"<b>"+("0000"+(256*i+16*t).toString(16).toUpperCase()).slice(-4)+"</b> "+Array.from(Array(16).keys()).map((function(e){return("00"+$.memory[256*i+16*t+e].toString(16)).slice(-2)})).join("&#8239;")+" "+Array.from(Array(16).keys()).map((function(e){return r=$.memory[256*i+16*t+e],(s=String.fromCharCode(r)).match(/[A-Za-z0-9]/)?s:".";var r,s})).join("")})).join("<br>"),document.getElementById("flags").innerHTML="S:"+ +$.status.S+" Z:"+ +$.status.Z+" A:"+ +$.status.A+" P:"+ +$.status.P+" C:"+ +$.status.C,document.getElementById("cycles").innerHTML=$.cycles.toString()}function nt(t){8===t.keyCode?($.input.push(t.keyCode),t.preventDefault(),t.stopPropagation()):27===t.keyCode?document.getElementById("output").blur():t.ctrlKey&&17!==t.keyCode&&($.input.push(63&t.keyCode),t.preventDefault(),t.stopPropagation())}function it(t){8!==t.keyCode&&($.input.push(t.keyCode),t.preventDefault(),t.stopPropagation())}function ot(){var t,e,r=document.getElementById("loadcode").value.replace(/^\s+|\s+$/g,""),n=i.fromHex(r);tt(),$.memory.set([118,0,0,0,0,195,6,236,118],0),$.memory.set(s,60422);try{for(var o=Y(n),a=o.next();!a.done;a=o.next()){var u=J(a.value,2),c=u[0],h=u[1];$.memory.set(h,c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}$.pc[0]=256,st()}window.onload=function(){q(),st(),document.getElementById("run").onclick=function(){return Q(1e4)},document.getElementById("animate").onclick=function(){return Q(1)},document.getElementById("step").onclick=K,document.getElementById("reset").onclick=q,document.getElementById("setbreakpoint").onclick=et,document.getElementById("clearbreakpoint").onclick=rt,document.getElementById("load").onclick=ot,document.getElementById("output").onkeypress=it,document.getElementById("output").onkeydown=nt,document.getElementById("page").onchange=st}}]);